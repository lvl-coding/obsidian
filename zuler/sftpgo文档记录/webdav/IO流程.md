# windows网络磁盘映射上传

webdav是基于HTTP的无状态协议，没有挂载操作。  
挂载应该是客户端针对服务端的一个记录行为，可以仅是首次进行了挂载目录的propfind请求，不涉及交互  
上传  
在PUT目标文件前，先尝试propfind获取目标文件的信息，期望为不存在  
然后lock加锁，返回获取独享锁成功  
HEAD获取属性  
PUT上传文件和数据，小文件则在本次一次上传，大文件tcp则自身开始分包  
上传完成后propfind获取属性  
释放锁
 
上传文件存在后端不支持的属性时，有所差异  
客户端会进行提示：是否不上传属性的情况下继续上传  
对应报文操作为：  
首先PUT空文件，  
对空文件加锁，  
DELETE操作，提示文件内容为空  
再次PUT空文件  
加锁  
HEAD获取属性  
携带数据上传文件  
获取属性后解锁文件
 
# S3

GET获取后端文件列表  
大文件采取分段上传，POST获取upload id，后续put进行uploadpart，分段大小默认5M