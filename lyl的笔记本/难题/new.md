# new和malloc的区别
 
1. new是操作符，malloc是库函数
2. new先分配内存，再调用构造函数；释放时调用析构函数
3. malloc需要指定内存大小，返回void*指针需要强转；new不用指定内存大小
4. new可以被重载
5. new更加直接和安全
6. new出错时抛出异常，malloc返回null
   

malloc：当开辟的空间小于128K时，调用brk()函数；当开辟的空间大于128K时，调用mmap()。采用内存池的管理方式，以减少内存碎片。先申请大块内存作为堆区，然后将堆区分为多个内存块。当用户申请内存时，直接从堆区分配一块合适的空闲块。采用隐式链表将所有空闲块，每一个空闲块记录了一个未分配的连续的内存地址
 
# pleasement new

手动管理：使用placement new后，需手动调用析构函数（而非delete），且需确保内存的正确释放。理由：placement new只是在现有的内存位置上构造对象，它不负责内存的分配。因此，当你使用placement new时，你必须已经为对象分配好了内存空间。由于delete操作会尝试释放由new操作分配的内存，使用它来释放通过placement new构造的对象会导致未定义行为，因为delete会尝试去释放一块它没有记录分配信息的内存。  
安全性考量：必须保证place指向的内存足够大，且未被其他对象占用，否则可能导致未定义行为。